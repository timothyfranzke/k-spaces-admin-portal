<div id="user" class="page-layout simple tabbed" layout="column">

  <!-- HEADER -->
  <div class="header" layout="row" layout-align="space-between center">
    <div class="white-fg" layout="column" layout-align="start start">
      <div class="h1" layout="row" layout-align="start center">
        <img ng-src="{{vm.user.avatar.thumb}}" width="100%" height="100%" ng-show="vm.user.hasImage" class="avatar"/>
        <img ng-src="assets/images/avatars/profile.jpg" width="100%" height="100%" ng-show="!vm.user.hasImage" class="avatar"/>
        <span>{{vm.user.name}}</span>
      </div>
    </div>
    <div>
      <md-button type="submit" class="md-raised md-accent" aria-label="Submit"
                 translate="EC.SAVE" ng-disabled="location.$invalid || location.$pristine" ng-click="vm.saveLocation()">
        Save
      </md-button>
    </div>
  </div>
  <!-- / HEADER -->

  <!-- CONTENT -->
  <div class="content">

    <md-tabs md-dynamic-height>

      <md-tab>
        <md-tab-label>
          <span translate="EC.BASIC_INFO">Basic Info</span>
        </md-tab-label>

        <md-tab-body>
          <div class="product-detail-form-container md-background-bg md-whiteframe-1dp">
            <form id="productForm" name="productForm">
              <div layout="row" flex="30">
                <div layout="row" ng-if="!!vm.image.full" layout-align="end">
                  <img ng-src="{{vm.image.full}}" width="100%" height="100%" class="blank_avatar"/>
                  <md-button ng-click="vm.createAvatar()" class="material-icons" style="right: 30px">edit</md-button>
                </div>
                <div layout="row" ng-if="!vm.image" layout-align="end">
                  <img ng-src="{{vm.user.avatar.thumb}}" width="100%" height="100%" ng-show="vm.user.hasImage" class="blank_avatar"/>
                  <img ng-src="assets/images/avatars/profile.jpg" width="100%" height="100%" ng-show="!vm.user.hasImage" class="blank_avatar"/>
                  <md-button ng-click="vm.createAvatar()" class="material-icons" style="right: 30px">edit</md-button>
                </div>
              </div>
              <div layout="column" layout-gt-sm="row" flex>
                <md-input-container class="md-block">
                  <label translate="EC.USER.FIRST_NAME">First Name</label>
                  <input type="text" ng-model="vm.user.legal_name.first" required>
                </md-input-container>
                <md-input-container class="md-block">
                  <label translate="EC.USER.MIDDLE_NAME">Middle Name</label>
                  <input type="text" ng-model="vm.user.legal_name.middle">
                </md-input-container>
                <md-input-container class="md-block">
                  <label translate="EC.USER.LAST_NAME">Last Name</label>
                  <input type="text" ng-model="vm.user.legal_name.last" required>
                </md-input-container>
              </div>
              <div layout="column" layout-gt-sm="row">
                <md-input-container>
                  <label>Role</label>
                  <md-select ng-model="vm.user.role">
                    <md-option ng-repeat="role in vm.roles" value="{{role}}">
                      {{role}}
                    </md-option>
                  </md-select>
                </md-input-container>
              </div>
            </form>
          </div>
        </md-tab-body>
      </md-tab>

      <!--<md-tab>
          <md-tab-label>
              <span translate="EC.SPACES_IMAGES">Space Images</span>
          </md-tab-label>

          <md-tab-body>
              <div class="product-detail-form-container md-background-bg md-whiteframe-1dp">

                  <div id="product-image-uploader"
                       flow-init="vm.ngFlowOptions"
                       flow-name="vm.ngFlow.flow"
                       flow-files-submitted="vm.upload()"
                       flow-file-added="vm.fileAdded($file)"
                       flow-file-success="vm.fileSuccess($file, $message)"
                       flow-complete="vm.uploadComplete()"
                       flow-drop
                       flow-drag-enter="vm.dropping=true"
                       flow-drag-leave="vm.dropping=false"
                       ng-class="{'dropping':vm.dropping}">

                      <div class="drop-text hint-text" layout="row" layout-align="center center">
                          <span translate="EC.DROP_TO_UPLOAD">Drop to upload</span>
                      </div>

                      <div class="upload-button" layout="column" layout-align="center center">
                          <md-button class="md-accent md-raised" flow-btn>
                              Upload
                          </md-button>
                          <span class="secondary-text mt-8">You can also drop images here to upload. Only PNG, JPG - Max. 8MB</span>
                      </div>

                      <div class="mv-32" layout="row" layout-align="center center">
                          <div class="image-zoom-area">
                              <img wip-image-zoom="vm.imageZoomOptions">
                          </div>
                      </div>

                      <div layout="row" layout-align="start start" layout-wrap>
                          <div ng-repeat="image in vm.product.images" ng-switch="image.type">
                              <div class="product-image uploading" ng-switch-when="uploading" layout="row"
                                   layout-align="center center">
                                  <div class="overlay" layout="column" layout-align="center center">
                                      <md-progress-linear md-mode="determinate"
                                                          value="{{image.file.progress() * 100}}">
                                      </md-progress-linear>
                                  </div>
                                  <img class="media" flow-img="image.file">
                              </div>

                              <div class="product-image" ng-switch-when="image" layout="row"
                                   layout-align="center center">
                                  <img class="media" ng-src="{{image.url}}"
                                       ng-click="vm.updateImageZoomOptions(image.url)">
                              </div>
                          </div>
                      </div>

                      <div class="p-8 font-size-12" layout="row" layout-align="center center">
                          Click on images to activate the zoom!
                      </div>
                  </div>
              </div>
          </md-tab-body>
      </md-tab>-->

      <md-tab>
        <md-tab-label>
          <span translate="EC.PRICING">Tuition</span>
        </md-tab-label>

        <md-tab-body>
          <div class="product-detail-form-container md-background-bg md-whiteframe-1dp">
            <form>
              <md-input-container class="md-block md-icon-float">
                <label translate="EC.TAX_INCL_PRICE">Tuition Cost</label>
                <md-icon md-font-icon="icon icon-currency-usd"></md-icon>
                <input type="number" step="0.01" ng-model="vm.product.priceTaxIncl">
              </md-input-container>

              <md-input-container class="md-block md-icon-float">
                <label translate="EC.TAX_RATE">Tax Rate</label>
                <md-icon md-font-icon="icon icon-percent"></md-icon>
                <input type="number" step="0.01" ng-model="vm.product.taxRate">
              </md-input-container>

              <md-input-container class="md-block md-icon-float" flex="35">
                <label translate="EC.OCCURENCE">Payment Occurence</label>
                <md-select ng-model="vm.product.occurence.type">
                  <md-option ng-repeat="occurence in vm.occurenceTypes" ng-value="occurence">
                    {{occurence}}
                  </md-option>
                </md-select>
              </md-input-container>

              <md-input-container class="md-block md-icon-float" ng-show="vm.product.occurence.type == 'Monthly (specific day)'">
                <label translate="EC.OCCURENCE_DAY">Occurs on Day</label>
                <input type="number" step="1" min="1" max="28" ng-model="vm.product.occurence.day">
              </md-input-container>
            </form>
          </div>
        </md-tab-body>
      </md-tab>
      <md-tab>
        <md-tab-label>
          <span translate="EC.STUDENTS">Faculty</span>
        </md-tab-label>

        <md-tab-body>
          <div class="product-detail-form-container md-background-bg md-whiteframe-1dp">
            <form>
              <div layout="row" layout-align="space-between start" >
                <md-autocomplete
                  flex="100"
                  md-no-cache="true"
                  md-selected-item="selectedItem"
                  md-search-text-change="vm.search(searchText)"
                  md-search-text="searchText"
                  md-selected-item-change="vm.selectItem(item)"
                  md-items="item in vm.items"
                  md-item-text="item.legal_name.first"
                  md-min-length="0"
                  placeholder="Add Student (Search Student Name)"
                <md-item-template>
                  <span md-highlight-text="searchText" md-highlight-flags="^i">{{item.legal_name.first}} {{item.legal_name.last}}</span>
                </md-item-template>
                <md-not-found>
                  No users matching "{{searchText}}" were found.
                </md-not-found>
                </md-autocomplete>
              </div>
            </form>
          </div>
          <div class="content fullpage-datatable" layout="column" flex>

            <table class="dataTable row-border hover" datatable="ng" dt-instance="vm.dtInstance"
                   dt-options="vm.dtTierStudents">
              <thead>
              <tr>
                <th class="secondary-text">
                  <div class="table-header">
                    <span class="column-title">Student</span>
                  </div>
                </th>
                <th class="secondary-text">
                  <div class="table-header">
                    <span class="column-title">Actions</span>
                  </div>
                </th>
              </tr>
              </thead>
              <tbody>
              <tr ng-repeat="student in vm.product.students" class="manageRow">
                <td>{{student.legal_name.first}} {{student.legal_name.last}}</td>
                <td>
                  <md-button class="edit-button md-icon-button" aria-label="Product details" ng-click="vm.removeStudent(student._id)"
                             translate translate-attr-aria-label="EC.PRODUCT_DETAILS">
                    <md-icon md-font-icon="icon-close" class="s16"></md-icon>
                  </md-button>
                </td>
              </tr>
              </tbody>
            </table>

          </div>
        </md-tab-body>
      </md-tab>
    </md-tabs>

  </div>
  <!-- / CONTENT -->

</div>
